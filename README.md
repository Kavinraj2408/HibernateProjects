These are sample projects created by me while learning
WITH PARAMS AS (SELECT 20260 GARAGEID,TO_DATE(06/25/2024,'MM/DD/YYYY') WORK_DATE, 'CP' REGION  from dual), REPORTING_SUPV AS (SELECT distinct reports_to_userid,TO_CHAR(P.GARAGEID) SUPV_GARAGEID, 0 LOANED_SUPERVISOR_FLAG FROM PARAMS P\r\n" + 
			"INNER JOIN RMDBA.EMP E ON E.ECFKGRGPK=P.GARAGEID AND E.ACTIVE_FLG='Y' AND E.DO_FLG='Y'\r\n" + 
			"INNER JOIN RMDBA.SITE_EMP SE ON SE.EMP_USERID=E.USERID AND SE.ROLE_NM='DOTECH' AND SE.DEFAULT_FLG='Y'\r\n" + 
			"INNER JOIN RMDBA.SITE   ON  SITE.ID=SE.SITE_ID AND  SITE.SRC_NM='DO-'||P.REGION\r\n" +  
			"),\r\n" + 
			"LOANED_SUPV AS (\r\n" + 
			"SELECT distinct E.reports_to_userid,TO_CHAR(E.ECFKGRGPK)  SUPV_GARAGEID,1 LOANED_SUPERVISOR_FLAG FROM PARAMS P\r\n" + 
			"inner join RMDBA.EC_LOAN ECL ON ECL.ECLOANFKGRGPK=P.GARAGEID AND  ECL.ECLOANDATE=p.work_date\r\n" + 
			"INNER JOIN RMDBA.EMP E ON E.USERID=ECL.ECLOANUSERID AND E.ACTIVE_FLG='Y' AND E.DO_FLG='Y'\r\n" + 
			"INNER JOIN RMDBA.SITE_EMP SE ON SE.EMP_USERID=E.USERID AND SE.ROLE_NM='DOTECH' AND SE.DEFAULT_FLG='Y'\r\n" + 
			"INNER JOIN RMDBA.SITE   ON  SITE.ID=SE.SITE_ID AND  SITE.SRC_NM='DO-'||P.REGION\r\n" + 
			"INNER JOIN RMDBA.SCHEDULE S ON S.EMP_USERID=E.USERID AND S.SCH_DT=TRUNC(SYSDATE)\r\n" + 
			"INNER JOIN RMDBA.ACTIVITY A ON A.CODE=PRIMARY_DUTY_CD AND A.PRODUCTIVE_FLG='Y'\r\n" + 
			"LEFT OUTER JOIN REPORTING_SUPV R ON r.reports_to_userid=E.reports_to_userid\r\n" + 
			"WHERE R.reports_to_userid IS   NULL\r\n" + 
			"),ALL_SUPV as (\r\n" + 
			"SELECT * FROM REPORTING_SUPV\r\n" + 
			"UNION \r\n" + 
			"SELECT * FROM LOANED_SUPV\r\n" + 
			"),\r\n" + 
			"FINAL_RESULT AS (\r\n" + 
			"SELECT  p.garageid SUPV_GARAGEID,p.garageid GARAGEID,A.LOANED_SUPERVISOR_FLAG, GRGNAME SUPV_GARAGE_NAME,UPPER(E.VZID)SUPV_VZID,E.USERID AS SUPV_USERID,  FIRST_NM SUPERVISOR_FIRSTNAME,LAST_NM SUPERVISOR_LASTNAME FROM ALL_SUPV A\r\n" + 
			"INNER JOIN RMDBA.GARAGE G ON G.GRGPK=A.SUPV_GARAGEID\r\n" + 
			"INNER JOIN RMDBA.EMP E ON E.USERID=A.REPORTS_TO_USERID\r\n" + 
			"INNER JOIN PARAMS P ON 1=1)
			SELECT F.*,H.CN SUPVERVISOR_FULLNAME FROM FINAL_RESULT F INNER JOIN RMDBA.HR_FEED H ON H.VZ_ID=lower(F.SUPV_VZID)   ORDER BY SUPERVISOR_LASTNAME , SUPERVISOR_FIRSTNAME";
